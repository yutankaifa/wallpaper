# 桌面壁纸设置工具

一个功能强大的Windows桌面壁纸设置工具，支持图片和视频壁纸。

## 功能特性

### 🖼️ 图片壁纸
- 支持多种图片格式：JPG、JPEG、PNG、BMP、GIF
- 实时预览功能
- 自适应缩放显示
- 文件大小限制：50MB以内

### 🎬 视频壁纸（新功能）
- 支持多种视频格式：MP4、AVI、MOV、WMV、MKV
- 实时视频预览
- 视频控制功能：
  - 播放/暂停控制
  - 停止播放
  - 音量调节
  - 自动循环播放
- 文件大小限制：500MB以内

## 使用方法

### 设置图片壁纸
1. 启动应用程序
2. 选择"图片壁纸"选项
3. 点击"选择媒体文件"按钮
4. 选择您想要的图片文件
5. 预览图片效果
6. 点击"设置为壁纸"按钮

### 设置视频壁纸
1. 启动应用程序
2. 选择"视频壁纸"选项
3. 点击"选择媒体文件"按钮
4. 选择您想要的视频文件
5. 使用视频控制按钮预览效果：
   - ▶/⏸ 播放/暂停
   - ⏹ 停止
   - 🔊 音量调节
6. 点击"设置为壁纸"按钮

## 技术特性

### 系统要求
- Windows 10/11
- .NET 8.0 Runtime
- 支持硬件加速的显卡（推荐）

### 技术实现
- **框架**: WPF (.NET 8.0)
- **UI设计**: 现代化响应式界面
- **图片处理**: WPF BitmapImage
- **视频处理**: MediaElement控件
- **系统集成**: Windows API (user32.dll)
- **安全性**: 文件类型验证和大小限制

### 视频壁纸技术说明
视频壁纸功能通过以下技术实现：
1. **基础实现**: 创建隐藏窗口播放视频
2. **高级功能**: 需要第三方软件支持完整的动态壁纸体验
3. **性能优化**: 自动循环播放，静音处理
4. **兼容性**: 支持主流视频格式

## 文件结构

```
WpfApp3/
├── MainWindow.xaml          # UI界面设计
├── MainWindow.xaml.cs       # 核心逻辑实现
├── App.xaml                 # 应用程序配置
├── App.xaml.cs              # 应用程序入口
└── README.md                # 项目文档
```

## 开发信息

- **开发语言**: C#
- **UI框架**: WPF
- **目标框架**: .NET 8.0
- **开发工具**: Visual Studio 2022

## 注意事项

1. **权限要求**: 需要管理员权限来修改系统壁纸设置
2. **文件大小**: 
   - 图片文件建议不超过50MB
   - 视频文件建议不超过500MB
3. **性能影响**: 视频壁纸可能会增加系统资源使用
4. **兼容性**: 某些视频格式可能需要额外的编解码器

## 更新日志

### v2.0.0 (最新)
- ✨ 新增视频壁纸功能
- ✨ 添加媒体类型选择
- ✨ 实现视频预览和控制
- ✨ 支持多种视频格式
- 🔧 优化用户界面
- 🔧 改进错误处理

### v1.0.0
- 🎉 初始版本发布
- ✨ 图片壁纸设置功能
- ✨ 图片预览功能
- ✨ 现代化UI设计